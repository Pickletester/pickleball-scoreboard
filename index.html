<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pickleball Scoreboard - Background Fix</title>
  <style>
    body { margin: 0; background: black; color: white; font-family: sans-serif; overflow: hidden; }
    
    .container { 
      position: relative; 
      width: 832px; 
      height: 384px; 
      display: flex; 
      border: 1px solid #444; 
      box-sizing: border-box;
      /* FIX: Ensures the image covers the area without distorting */
      background-image: url('BackgroundSB.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

    .player-area { width: 245px; display: flex; flex-direction: column; background: rgba(26, 54, 93, 0.7); }
    .player-box { height: 192px; border: 1px solid rgba(255,255,255,0.3); display: flex; align-items: center; justify-content: center; }
    
    .score-area { width: 110px; border: 1px solid rgba(255,255,255,0.3); background: rgba(128, 128, 128, 0.7); display: flex; flex-direction: column; align-items: center; justify-content: center; }

    .info-panel { 
      flex-grow: 1; 
      padding: 15px; 
      text-align: center; 
      display: flex;
      flex-direction: column;
      justify-content: space-between; 
      height: 100%;
      box-sizing: border-box;
      background: rgba(0, 0, 0, 0.6); /* Semi-transparent black to show court behind it */
    }

    input { background: none; border: none; color: white; font-weight: bold; text-align: center; width: 100%; outline: none; }
    .input-p { font-size: 32px; }
    .input-s { font-size: 140px; line-height: 1; }
    
    .info-label { font-size: 22px; color: #aaa; text-transform: uppercase; margin-bottom: 2px; }
    .input-info { font-size: 34px; color: white; }

    .controls button { background: #333; color: white; border: 1px solid white; cursor: pointer; padding: 5px 12px; font-size: 18px; }
    #clock { font-size: 36px; color: #00ffcc; font-weight: bold; }
    .swap-btn-large { padding: 12px; font-size: 20px; background: #444; border: 2px solid white; color: white; cursor: pointer; text-transform: uppercase; }
  </style>
</head>
<body>

<div class="container">
  <div class="player-area">
    <div class="player-box"><input id="p4" class="input-p" value="PLAYER 4"></div>
    <div class="player-box"><input id="p3" class="input-p" value="PLAYER 3"></div>
  </div>
  <div class="score-area">
    <input id="score1" class="input-s" value="0">
    <div class="controls"><button onclick="adjust('score1', 1)">▲</button><button onclick="adjust('score1', -1)">▼</button></div>
  </div>
  <div class="score-area">
    <input id="score2" class="input-s" value="0">
    <div class="controls"><button onclick="adjust('score2', 1)">▲</button><button onclick="adjust('score2', -1)">▼</button></div>
  </div>
  <div class="player-area">
    <div class="player-box"><input id="p1" class="input-p" value="PLAYER 1"></div>
    <div class="player-box"><input id="p2" class="input-p" value="PLAYER 2"></div>
  </div>
  <div class="info-panel">
    <div>
      <div class="info-label">EVENT NAME</div>
      <input id="event" class="input-info" value="TEST">
    </div>
    <div>
      <div class="info-label">GAMES</div>
      <input id="games" class="input-info" value="0-0, 0-0">
    </div>
    <div id="clock">00:00:00 PM</div>
    <button class="swap-btn-large" onclick="swap()">SWAP SIDES</button>
  </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
  import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

  const firebaseConfig = {
    databaseURL: "https://pickleballscoreboard-a963e-default-rtdb.firebaseio.com",
    projectId: "pickleballscoreboard-a963e",
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const dbRef = ref(db, 'scoreboard');

  onValue(dbRef, (snapshot) => {
    const data = snapshot.val();
    if (data) {
      Object.keys(data).forEach(id => {
        const el = document.getElementById(id);
        if (el && el.value !== String(data[id])) el.value = data[id];
      });
    }
  });

  function sync() {
    const data = {};
    document.querySelectorAll('input').forEach(el => data[el.id] = el.value);
    set(dbRef, data);
  }

  document.querySelectorAll('input').forEach(el => el.oninput = sync);

  window.adjust = (id, amt) => {
    const el = document.getElementById(id);
    el.value = Math.max(0, parseInt(el.value || 0) + amt);
    sync();
  };

  window.swap = () => {
    const p1 = document.getElementById('p1').value, p2 = document.getElementById('p2').value;
    const p3 = document.getElementById('p3').value, p4 = document.getElementById('p4').value;
    const s1 = document.getElementById('score1').value, s2 = document.getElementById('score2').value;
    document.getElementById('p1').value = p4; document.getElementById('p4').value = p1;
    document.getElementById('p2').value = p3; document.getElementById('p3').value = p2;
    document.getElementById('score1').value = s2; document.getElementById('score2').value = s1;
    sync();
  };

  setInterval(() => {
    document.getElementById('clock').innerText = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit', second:'2-digit'});
  }, 1000);
</script>
</body>
</html>
