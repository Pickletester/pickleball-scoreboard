<!-- Add Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>

<script>
  // Your Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyD_unRHQhjXS0JZ1ON-4u0KfNX4lIqNlbU",
    authDomain: "pickleballscoreboard-a963e.firebaseapp.com",
    databaseURL: "https://pickleballscoreboard-a963e-default-rtdb.firebaseio.com",
    projectId: "pickleballscoreboard-a963e",
    storageBucket: "pickleballscoreboard-a963e.appspot.com",
    messagingSenderId: "858315041471",
    appId: "1:858315041471:web:59bf87df2f4dae68de740a"
  };

  // Initialize Firebase
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  function updateTime() {
    const now = new Date();
    const options = {
      timeZone: 'America/New_York',
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
      hour12: true
    };
    const formatter = new Intl.DateTimeFormat('en-US', options);
    document.getElementById('currentTime').textContent = formatter.format(now);
  }
  setInterval(updateTime, 1000);
  updateTime();

  // IDs to sync
  const ids = ['p1', 'p2', 'p3', 'p4', 'score1', 'score2', 'gameScore', 'eventName'];

  // Send updates to Firebase on change
  ids.forEach(id => {
    const el = document.getElementById(id);
    el.addEventListener('input', () => {
      firebase.database().ref('scoreboard/' + id).set(el.value);
    });
  });

  // Listen for changes from Firebase
  ids.forEach(id => {
    firebase.database().ref('scoreboard/' + id).on('value', snapshot => {
      const newVal = snapshot.val();
      if (newVal !== null && document.getElementById(id).value !== newVal) {
        document.getElementById(id).value = newVal;
      }
    });
  });

  function adjustScore(id, delta) {
    const input = document.getElementById(id);
    let current = parseInt(input.value) || 0;
    current = Math.max(0, current + delta);
    input.value = current;
    firebase.database().ref('scoreboard/' + id).set(current);
  }

  function swapSides() {
    let tempP1 = document.getElementById('p1').value;
    let tempP2 = document.getElementById('p2').value;
    let tempScore1 = document.getElementById('score1').value;

    document.getElementById('p1').value = document.getElementById('p4').value;
    document.getElementById('p2').value = document.getElementById('p3').value;
    document.getElementById('score1').value = document.getElementById('score2').value;

    document.getElementById('p4').value = tempP1;
    document.getElementById('p3').value = tempP2;
    document.getElementById('score2').value = tempScore1;

    // Update Firebase after swap
    ids.forEach(id => {
      firebase.database().ref('scoreboard/' + id).set(document.getElementById(id).value);
    });
  }
</script>
