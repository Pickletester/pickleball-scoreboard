<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Scoreboard</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100%;
      width: 100%;
    }
    body {
      background: url('BackgroundSB.png') no-repeat center center;
      background-size: cover;
      font-family: Arial, sans-serif;
      color: white;
    }
    .container {
      position: absolute;
      bottom: 20px;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 32px;
    }
    .row {
      display: flex;
      justify-content: space-around;
      align-items: center;
      margin: 5px 0;
    }
    .name, .score {
      min-width: 120px;
    }
    .swap-button {
      margin-top: 10px;
      padding: 5px 20px;
      font-size: 20px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div class="container">
  <div class="row">
    <div class="name" id="player1Name">Player 1</div>
    <div class="name" id="player2Name">Player 2</div>
  </div>
  <div class="row">
    <div class="score" id="player1Score">00</div>
    <div class="score" id="player2Score">00</div>
  </div>
  <div class="row">
    <div class="score" id="player4Score">00</div>
    <div class="score" id="player3Score">00</div>
  </div>
  <div class="row">
    <div class="name" id="player4Name">Player 4</div>
    <div class="name" id="player3Name">Player 3</div>
  </div>
  <button class="swap-button" onclick="swapPlayers()">Swap Sides</button>
</div>

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyD_unRHQhjXS0JZ1ON-4u0KfNX4lIqNlbU",
    authDomain: "pickleballscoreboard-a963e.firebaseapp.com",
    databaseURL: "https://pickleballscoreboard-a963e-default-rtdb.firebaseio.com",
    projectId: "pickleballscoreboard-a963e",
    storageBucket: "pickleballscoreboard-a963e.appspot.com",
    messagingSenderId: "858315041471",
    appId: "1:858315041471:web:59bf87df2f4dae68de740a",
    measurementId: "G-N1Y4292E8V"
  };

  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app);

  const dbRefs = {
    player1Name: ref(database, 'player1/name'),
    player2Name: ref(database, 'player2/name'),
    player3Name: ref(database, 'player3/name'),
    player4Name: ref(database, 'player4/name'),
    player1Score: ref(database, 'player1/score'),
    player2Score: ref(database, 'player2/score'),
    player3Score: ref(database, 'player3/score'),
    player4Score: ref(database, 'player4/score')
  };

  for (const [id, dbRef] of Object.entries(dbRefs)) {
    const el = document.getElementById(id);
    if (el) {
      onValue(dbRef, (snapshot) => {
        el.textContent = snapshot.val() ?? (id.includes('Score') ? '00' : 'Player');
      });
    }
  }

  window.swapPlayers = () => {
    const updates = {};
    const names = ['player1', 'player2', 'player3', 'player4'];

    const getVal = id => document.getElementById(id).textContent;

    updates['player1/name'] = getVal('player4Name');
    updates['player2/name'] = getVal('player3Name');
    updates['player3/name'] = getVal('player2Name');
    updates['player4/name'] = getVal('player1Name');

    updates['player1/score'] = getVal('player4Score');
    updates['player2/score'] = getVal('player3Score');
    updates['player3/score'] = getVal('player2Score');
    updates['player4/score'] = getVal('player1Score');

    for (const [key, value] of Object.entries(updates)) {
      set(ref(database, key), value);
    }
  };
</script>

</body>
</html>
