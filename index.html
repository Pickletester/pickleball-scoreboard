<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pickleball Scoreboard</title>
  <style>
    body { margin: 0; background: black; color: white; font-family: sans-serif; overflow: hidden; }
    .container { position: relative; width: 832px; height: 384px; display: flex; border: 1px solid #444; }
    .player-area { width: 245px; display: flex; flex-direction: column; }
    .player-box { height: 192px; border: 1px solid white; background: #1a365d; display: flex; align-items: center; justify-content: center; }
    .score-area { width: 110px; border: 1px solid white; background: #808080; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    .info-panel { flex-grow: 1; padding: 20px; text-align: right; }
    input { background: none; border: none; color: white; font-weight: bold; text-align: center; width: 100%; outline: none; }
    .input-p { font-size: 24px; }
    .input-s { font-size: 85px; }
    .controls button { background: #333; color: white; border: 1px solid white; cursor: pointer; padding: 5px 10px; margin: 2px; }
    #clock { font-size: 18px; margin-top: 50px; }
  </style>
</head>
<body>

<div class="container">
  <div class="player-area">
    <div class="player-box"><input id="p4" class="input-p" value="PLAYER 4"></div>
    <div class="player-box"><input id="p3" class="input-p" value="PLAYER 3"></div>
  </div>
  <div class="score-area">
    <input id="score1" class="input-s" value="0">
    <div class="controls"><button onclick="adjust('score1', 1)">▲</button><button onclick="adjust('score1', -1)">▼</button></div>
  </div>
  <div class="score-area">
    <input id="score2" class="input-s" value="0">
    <div class="controls"><button onclick="adjust('score2', 1)">▲</button><button onclick="adjust('score2', -1)">▼</button></div>
  </div>
  <div class="player-area">
    <div class="player-box"><input id="p1" class="input-p" value="PLAYER 1"></div>
    <div class="player-box"><input id="p2" class="input-p" value="PLAYER 2"></div>
  </div>
  <div class="info-panel">
    EVENT NAME<br><input id="event" value="TOURNAMENT" style="text-align:right;"><br><br>
    GAMES<br><input id="games" value="0-0, 0-0" style="text-align:right;"><br>
    <div id="clock">00:00:00 PM</div>
    <button onclick="swap()" style="margin-top:20px; background: #444; color:white; border:1px solid white; cursor:pointer;">SWAP SIDES</button>
  </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
  import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

  const firebaseConfig = {
    databaseURL: "https://pickleballscoreboard-a963e-default-rtdb.firebaseio.com",
    projectId: "pickleballscoreboard-a963e",
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const dbRef = ref(db, 'scoreboard');

  // Listen for updates from other browsers
  onValue(dbRef, (snapshot) => {
    const data = snapshot.val();
    if (data) {
      Object.keys(data).forEach(id => {
        const el = document.getElementById(id);
        if (el && el.value !== data[id]) el.value = data[id];
      });
    }
  });

  // Function to send data to Firebase
  function sync() {
    const data = {};
    document.querySelectorAll('input').forEach(el => data[el.id] = el.value);
    set(dbRef, data);
  }

  // Attach sync to all inputs
  document.querySelectorAll('input').forEach(el => el.oninput = sync);

  window.adjust = (id, amt) => {
    const el = document.getElementById(id);
    el.value = Math.max(0, parseInt(el.value) + amt);
    sync();
  };

  window.swap = () => {
    const p1 = document.getElementById('p1').value, p2 = document.getElementById('p2').value;
    const p3 = document.getElementById('p3').value, p4 = document.getElementById('p4').value;
    const s1 = document.getElementById('score1').value, s2 = document.getElementById('score2').value;
    document.getElementById('p1').value = p4; document.getElementById('p4').value = p1;
    document.getElementById('p2').value = p3; document.getElementById('p3').value = p2;
    document.getElementById('score1').value = s2; document.getElementById('score2').value = s1;
    sync();
  };

  setInterval(() => {
    document.getElementById('clock').innerText = new Date().toLocaleTimeString();
  }, 1000);
</script>
</body>
</html>
